<?xml version="1.0" encoding="utf-8"?>
<Template id="predictiveMaintenance">
  <Category>Demo</Category>
  <Title>Manufacturing Template</Title>
  <Owner displayname="Daniel Grecoe" email="grecoe@microsoft.com" />
  <PublishedOn>09/27/2016</PublishedOn>
  <ImageUrl>{PatternAssetBaseUrl}/manufacturing.png</ImageUrl>
  <Description>Manufacturing Template [TBD]</Description>
  <Summary>
    <Tabs>
      <Tab src="ManufacturingTemplateDescription.md" format="markdown" title="Description" />
    </Tabs>
  </Summary>
  <EstimatedTime>30 Minutes</EstimatedTime>
  <Ingredients>
    <Ingredient>Web</Ingredient>
    <Ingredient>EventHub</Ingredient>
    <Ingredient>StreamAnalytics</Ingredient>
    <Ingredient>StorageAccount</Ingredient>
    <Ingredient>MachineLearning</Ingredient>
    <Ingredient>PowerBi</Ingredient>
  </Ingredients>
  <ProvisioningSteps>
    <ArmDeployment source="Phase1.json" title="Create EventHub, ML Workspace and other WebApp">
      <Parameters>
        <Parameter name="baseUrl" hidden="true">
          <DefaultValue>{PatternAssetBaseUrl}</DefaultValue>
        </Parameter>
        <Parameter name="powerBiUserId" hidden="true">
          <DefaultValue>{UserId}</DefaultValue>
        </Parameter>
        <Parameter name="powerBiUserDisplayName" hidden="true">
          <DefaultValue>{UserDisplayName}</DefaultValue>
        </Parameter>
      </Parameters>
    </ArmDeployment>
    <WebJob title="Copy ML Experiments">
      <Parameters>
        <Parameter name="appName" defaultValue="{Outputs.webJobSiteName}" />
        <Parameter name="jobName" defaultValue="{Outputs.mlSvcWebJobName}" />
      </Parameters>
    </WebJob>
    <ArmDeployment source="Phase2.json" title="Create Stream Analytics Job">
      <Parameters>
        <Parameter name="powerBiUserId" hidden="true">
          <DefaultValue>{Outputs.powerBiUserId}</DefaultValue>
        </Parameter>
        <Parameter name="powerBiUserDisplayName" hidden="true">
          <DefaultValue>{Outputs.powerBiUserDisplayName}</DefaultValue>
        </Parameter>
        <Parameter name="mlFunctionEndpointWaypoint0" hidden="true">
          <DefaultValue>{Outputs.mlFunctionEndpointWaypoint0}</DefaultValue>
        </Parameter>
        <Parameter name="mlFunctionApiKeyWaypoint0" hidden="true">
          <DefaultValue>{Outputs.mlFunctionApiKeyWaypoint0}</DefaultValue>
        </Parameter>
        <Parameter name="mlFunctionEndpointWaypoint1" hidden="true">
          <DefaultValue>{Outputs.mlFunctionEndpointWaypoint1}</DefaultValue>
        </Parameter>
        <Parameter name="mlFunctionApiKeyWaypoint1" hidden="true">
          <DefaultValue>{Outputs.mlFunctionApiKeyWaypoint1}</DefaultValue>
        </Parameter>
        <Parameter name="mlFunctionEndpointWaypoint2" hidden="true">
          <DefaultValue>{Outputs.mlFunctionEndpointWaypoint2}</DefaultValue>
        </Parameter>
        <Parameter name="mlFunctionApiKeyWaypoint2" hidden="true">
          <DefaultValue>{Outputs.mlFunctionApiKeyWaypoint2}</DefaultValue>
        </Parameter>
        <Parameter name="mlFunctionEndpointWaypoint3" hidden="true">
          <DefaultValue>{Outputs.mlFunctionEndpointWaypoint3}</DefaultValue>
        </Parameter>
        <Parameter name="mlFunctionApiKeyWaypoint3" hidden="true">
          <DefaultValue>{Outputs.mlFunctionApiKeyWaypoint3}</DefaultValue>
        </Parameter>
        <Parameter name="mlFunctionEndpointWaypoint4" hidden="true">
          <DefaultValue>{Outputs.mlFunctionEndpointWaypoint4}</DefaultValue>
        </Parameter>
        <Parameter name="mlFunctionApiKeyWaypoint4" hidden="true">
          <DefaultValue>{Outputs.mlFunctionApiKeyWaypoint4}</DefaultValue>
        </Parameter>
        <Parameter name="ingestEventHubName" hidden="true">
          <DefaultValue>{Outputs.ingestEventHubName}</DefaultValue>
        </Parameter>
        <Parameter name="namespaceName" hidden="true">
          <DefaultValue>{Outputs.namespaceName}</DefaultValue>
        </Parameter>
        <Parameter name="sbKeyName" hidden="true">
          <DefaultValue>{Outputs.sbKeyName}</DefaultValue>
        </Parameter>
        <Parameter name="sharedAccessPolicyKey" hidden="true">
          <DefaultValue>{Outputs.sharedAccessPolicyKey}</DefaultValue>
        </Parameter>
      </Parameters>
    </ArmDeployment>
    <Manual title="Done">
      <Instructions src="ManufacturingTemplateInstructions.md" format="markdown" />
    </Manual>
  </ProvisioningSteps>
</Template>